---
title: "ã‚·ã‚§ãƒ«èŠ¸ã§GitHubã®æ—¥ä»˜åˆ¥Contributeæ•°ã‚’å–å¾—"
emoji: "ğŸ˜€"
type: "tech"
topics: [Bash,awk,curl,grep,ã‚·ã‚§ãƒ«èŠ¸]
published: true
---
## æ¦‚è¦

ã‚·ã‚§ãƒ«èŠ¸ã§æ—¥ä»˜åˆ¥ã®GitHubã®è‰æƒ…å ±ã‚’å–å¾—ã—æ—¥ä»˜åˆ¥ã«Contributeæ•°ã‚’æ•´å½¢ã—ã¦è¡¨ç¤ºã—ãŸã„.

## ã‚„ã£ã¦ã¿ãŸ

ã¾ãšåˆ—æŒ™.

<https://github.com/users/eggplants/contributions>ã®ã‚½ãƒ¼ã‚¹ã‚’è¦‹ã‚‹ã¨, è‰ã®éƒ¨åˆ†ã«`<rect>`è¦ç´ ãŒåˆ—æŒ™ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹.

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/2b339dc0-684f-b3db-fcd4-6a3e2cf557f4.png)

ã—ã‹ã—`<rect>`è¦ç´ ã‚’æŠœãå‡ºã™ã¨

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/e74ae560-99c4-a5a5-49dd-f4b41692e739.png)

ã®ã‚ˆã†ãªéƒ¨åˆ†ã‚‚å–å¾—ã—ã¦ã—ã¾ã†. ãªã®ã§ä»¥ä¸‹ã®ã‚ˆã†ãªè‰æ¿ƒåº¦éƒ¨åˆ†ã®`<rect>`ã¯é™¤ãå¿…è¦ãŒã‚ã‚‹.

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/46d6e044-05b9-d6b0-514f-2938837716c3.png)

ã®ã§, ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹.

```bash
$ curl -s https://github.com/users/eggplants/contributions \
  | awk '/data-count/{print$9,$10}'
```

ã©ã†ã‚„ã‚‰ç›´è¿‘1å¹´åˆ†å–å¾—ã§ããã†ã .

```:result
data-count="0" data-date="2020-02-23"
data-count="0" data-date="2020-02-24"
data-count="1" data-date="2020-02-25"
data-count="0" data-date="2020-02-26"
data-count="1" data-date="2020-02-27"
...(çœç•¥)...
data-count="5" data-date="2021-02-20"
data-count="6" data-date="2021-02-21"
data-count="1" data-date="2021-02-22"
data-count="0" data-date="2021-02-23"
data-count="7" data-date="2021-02-24"
```

æ—¥ä»˜ã¨Contributeæ•°ã‚’ä¸¦ã¹ã¦è¡¨ç¤º.

```bash
$ curl -s https://github.com/users/eggplants/contributions \
  | awk '/data-count/{print$9,$10}' | awk -F\" '$0=$4" "$2'
```

å¤§åˆ†æ‰±ã„ã‚„ã™ã„å½¢å¼ã«ãªã£ãŸ.

```:result
2020-02-23 0
2020-02-24 0
2020-02-25 1
2020-02-26 0
2020-02-27 1
...(çœç•¥)...
2021-02-20 5
2021-02-21 6
2021-02-22 1
2021-02-23 0
2021-02-24 7
```

è©¦ã—ã«, ã“ã“ã‹ã‚‰æ˜¨æ—¥ã®contributeæ•°ã‚’æ¤œç´¢ã—ã¦ã¿ã‚‹.

```bash
$ date
2021å¹´  2æœˆ 25æ—¥ æœ¨æ›œæ—¥ 02:13:11 JST
$ date +%Y-%m-%d
2021-02-23
$ date +%Y-%m-%d -d "1 day ago"
2021-02-24
$ curl -s https://github.com/users/eggplants/contributions \
  | awk '/data-count/{print$9,$10}' | awk -F\" '$0=$4" "$2' \
  | grep "$(date +%Y-%m-%d -d "1 day ago")"
2021-02-24 7
```

å–å¾—ã§ããŸ.



## å¿œç”¨

[eggplants/contributter.sh](https://github.com/eggplants/contributter.sh/blob/master/contributter)

```bash
contributter(){
  local user="$1" day_before="${2-1}"
  local target_date="$(date +%Y-%m-%d -d "${day_before} day ago")"
  echo "${user} ã•ã‚“ã® ${target_date//-//} ã® contribution æ•°: $(
    curl -s https://github.com/users/${user}/contributions \
      | grep -oP "(?<=data-count=\")[0-9]+(?=\" data-date=\"${target_date})"
  ) #contributter_report"
}
```

```bash:result
$ contributter eggplants
eggplants ã•ã‚“ã® 2021/02/24 ã® contribution æ•°: 7 #contributter_report
$ conributter eggplants 2
eggplants ã•ã‚“ã® 2021/02/23 ã® contribution æ•°: 0 #contributter_report
```

### è§£èª¬

- ç¬¬ä¸€å¼•æ•°ã¯ãƒ¦ãƒ¼ã‚¶å(`user`), ç¬¬2å¼•æ•°ã¯næ—¥å‰(`day_before`)ã‚’è¡¨ã™.
ã¾ãŸç¬¬2å¼•æ•°ãŒå­˜åœ¨ã—ãªã„å ´åˆ, `${å¤‰æ•°-ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤}`æ§‹æ–‡ã§`1`ãŒä»£å…¥ã•ã‚Œã‚‹.

- `target_date`ã«ã¯, næ—¥å‰ã®æ—¥ä»˜ã‚’`YYYY-mm-dd`å½¢å¼ã§ä»£å…¥ã™ã‚‹.

- `${target_date//-//}`ã¯, `${å¤‰æ•°//ç½®æ›ãƒ‘ã‚¿ãƒ¼ãƒ³/ç½®æ›æ–‡å­—}`æ§‹æ–‡ã§, `YYYY-mm-dd`ã‚’`YYYY/mm/dd`ã«ç½®æ›ã—ã¦ã„ã‚‹.

- å‰é …ã§è¡Œã£ã¦ã„ãŸ, `awk`ã«ã‚ˆã‚‹ç‰¹å®šæ—¥ä»˜ã®Contributeæ•°å–å¾—ã®éƒ¨åˆ†ã¯, `grep`ã®è‚¯å®šå…ˆ/å¾Œèª­ã¿`(?<=before-pattern)value(?=after-pattern)`ã§ã†ã¾ãæŠ½å‡ºã§ãã‚‹.

## çµè«–

ã‚·ã‚§ãƒ«èŠ¸ã§ã‚„ã‚‹å¿…è¦ã‚ã‚‹ï¼Ÿ

