---
title: " GitHub Actionsã‚¢ã‚¯ã‚·ãƒ§ãƒ³è‡ªä½œã‹ã‚‰Marketplaceå…¬é–‹ã¾ã§"
emoji: "ğŸ˜€"
type: "tech"
topics: [Python,GitHub,Twitter,Docker,GitHubActions]
published: true
---
ã“ã®è¨˜äº‹ã¯ã€[klis Advent Calendar 2020](https://adventar.org/calendars/5135)ã®~~21~~20æ—¥ç›®ã§ã™ã€‚
ä»Šå¹´ã‚‚[å»å¹´](https://qiita.com/eggplants/items/c956b87250ea29a26b85)ã«å¼•ãç¶šãã€klisè¦ç´ ã®è–„ã„è¨˜äº‹ã«ãªã‚Šã¾ã™â€¦

# ç›®æ¬¡

- <a href="#%E4%BD%95%E3%82%92%E3%81%99%E3%82%8B%E3%81%AE%E3%81%8B">ä½•ã‚’ã™ã‚‹ã®ã‹</a>
- <a href="#github-actions%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">GitHub Actionsã«ã¤ã„ã¦</a>
  - <a href="#%E9%81%B8%E6%8A%9E%E8%82%A2">é¸æŠè‚¢</a>
  - <a href="#docker-container%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E6%A7%8B%E6%88%90">Docker Containerã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æ§‹æˆ</a>
- <a href="#%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B">ä½œã£ã¦ã¿ã‚‹</a>
  - <a href="#actionsyml">actions.yml</a>
      - <a href="#name-author-description">name, author, description</a>
      - <a href="#inputs">inputs</a>
      - <a href="#runs">runs</a>
      - <a href="#branding">branding</a>
  - <a href="#dockerfile">Dockerfile</a>
  - <a href="#%E5%AE%9F%E9%9A%9B%E3%81%AE%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%86%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0">å®Ÿéš›ã®å‡¦ç†ã‚’è¡Œã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ </a>
- <a href="#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E3%83%86%E3%82%B9%E3%83%88%E3%81%99%E3%82%8B">ä½œæˆã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹</a>
- <a href="#marketplace%E3%81%AB%E5%85%AC%E9%96%8B%E3%81%99%E3%82%8B">Marketplaceã«å…¬é–‹ã™ã‚‹</a>
- <a href="#%E5%85%AC%E9%96%8B%E3%81%97%E3%81%9F%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E5%AE%9A%E6%9C%9F%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%A6%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B">å…¬é–‹ã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šæœŸå®Ÿè¡Œã—ã¦ä½¿ã£ã¦ã¿ã‚‹</a>
- <a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB">ãŠã‚ã‚Šã«</a>

# ä½•ã‚’ã™ã‚‹ã®ã‹

ãƒªãƒã‚¸ãƒˆãƒª: [**eggplants/twitter-weathername-action**](https://github.com/eggplants/twitter-weathername-action)

GitHub Actionsä¸Šã§å‹•ãã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’Python+Dockerãƒ™ãƒ¼ã‚¹ã§ä½œæˆã—ã€GitHubã®[Marketplace](https://github.com/marketplace)ã«å…¬é–‹ã™ã‚‹ã¾ã§ã®æ‰‹é †ã‚’è§£èª¬ã—ã¾ã™ã€‚
ä¾‹ã¨ã—ã¦ä½œæˆã™ã‚‹ã®ã¯ã€Twitterã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒãƒ¼ãƒ ã‚’ä¸‹ã®å†™çœŸã®ã‚ˆã†ã«ã€**æ˜æ—¥ã®3æ™‚é–“å¤©æ°—äºˆå ±**ã«ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/d78bd1e9-45b5-e8ae-8c05-0451a1d18fbf.png)

ã¾ãŸã€æ™®æ®µãŠæ‰‹æŒã¡ã®ã‚µãƒ¼ãƒã‚„VPSä¸Šã§èµ°ã‚‰ã›ã¦ã„ã‚‹ã‚ˆã†ãª**æ¯æ—¥JST00:00ã«ãªã‚‹ã¨è‡ªå‹•ã§æ›´æ–°**ã™ã‚‹å®šæœŸå®Ÿè¡Œã®cronã‚’GitHub Actionsä¸Šã§å®Œå…¨ç„¡æ–™ãƒ»ã‚µãƒ¼ãƒãªã—ã§ã‚„ã£ã¦ã¿ã¾ã™ã€‚
~~ä½†ã—ã€èµ°ã‚‰ã›ã‚‹ãŸã‚ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒâ€¦~~

ä»Šå›ä½œæˆã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ãŸWorkflowã¯[ã“ã¡ã‚‰](https://github.com/eggplants/twitter-weathername-action/blob/main/.github/workflows/cron_renamer.yml)ã€ã¾ãŸMarketplaceã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å…¬é–‹ã—ãŸã‚‚ã®ã¯[ã“ã¡ã‚‰](https://github.com/marketplace/actions/twitter-weathername)ã§ã™ã€‚

<blockquote class="twitter-tweet"><p lang="und" dir="ltr"><a href="https://t.co/ufco0Vy7VO">https://t.co/ufco0Vy7VO</a></p>&mdash; æ˜æ—¥: â˜€/â˜€/â˜€/â˜€/â˜€/â˜€/â˜/â˜ (@egpl0) <a href="https://twitter.com/egpl0/status/1341039332245741569?ref_src=twsrc%5Etfw">December 21, 2020</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

# GitHub Actionsã«ã¤ã„ã¦

GitHub Actionsã¨ã¯ã€GitHubãŒæä¾›ã—ã¦ã„ã‚‹CI/CDã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ãƒªãƒã‚¸ãƒˆãƒªã®`.github/workflows`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«yamlã‚’æ›¸ãã€pushã‚„pull requestã€ã¾ãŸå®šæœŸå®Ÿè¡Œã™ã‚‹scheduleãªã©ã®ãƒˆãƒªã‚¬ã§èµ°ã‚‰ã›ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚ã¾ãŸã€å…¬é–‹ãƒªãƒã‚¸ãƒˆãƒªã§ã‚ã‚Œã°**å®Œå…¨ç„¡æ–™**ã§å›ã—æ”¾é¡Œãªã®ã‚‚é­…åŠ›çš„ã§ã™ã€‚ãªãŠã€éå…¬é–‹ãƒªãƒã‚¸ãƒˆãƒªã‚„organizationãƒªãƒã‚¸ãƒˆãƒªã§ã¯ä¸€å®šé‡ä½¿ç”¨ã™ã‚‹ã¨[èª²é‡‘ã•ã‚Œã¾ã™](https://docs.github.com/en/free-pro-team@latest/github/setting-up-and-managing-billing-and-payments-on-github/about-billing-for-github-actions#about-billing-for-github-actions)ã€‚

## é¸æŠè‚¢

Actionsä½œæˆã«ã¯3ã¤ã®ä½œã‚Šæ–¹ãŒã‚ã‚Šã¾ã™ã€‚(`actions.yml`ã«è¨˜è¿°)

- [Docker Containerã‚¢ã‚¯ã‚·ãƒ§ãƒ³](https://docs.github.com/en/free-pro-team@latest/actions/creating-actions/creating-a-docker-container-action)

```yaml:action.yml
runs:
  using: 'docker'
  image: 'Dockerfile'
```

- [Javascriptã‚¢ã‚¯ã‚·ãƒ§ãƒ³](https://docs.github.com/en/free-pro-team@latest/actions/creating-actions/creating-a-javascript-action)

```yaml:action.yml
runs:
  using: 'node12'
  main: 'hogehoge.js'
```

- [è¤‡åˆå®Ÿè¡Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³](https://docs.github.com/en/free-pro-team@latest/actions/creating-actions/creating-a-composite-run-steps-action)

```yaml:action.yml
runs:
  using: 'composite'
```

ä»Šå›ã¯ã“ã®ã†ã¡ã®Docker Containerã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½œã‚Šã¾ã™ã€‚

## Docker Containerã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æ§‹æˆ

å¤§ããåˆ†ã‘ã¦3ã¤ã®éƒ¨åˆ†ã‚’æ›¸ã‘ã°ã‚ˆãã€

- [**action.yml**](https://github.com/eggplants/twitter-weathername-action/blob/main/action.yml)
    - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®èª¬æ˜
    - æ¸¡ã™å¼•æ•°ã®åå‰ã€èª¬æ˜ã€å±æ€§ã€å¿…é ˆã‹ã©ã†ã‹ã€è¿”ã‚Šå€¤ã‚’å®šç¾©
    - Marketplaceã§ã®å…¬é–‹æ™‚ã®ã‚¢ã‚¤ã‚³ãƒ³ã¨ãã®èƒŒæ™¯è‰²
- [**Dockerfile**](https://github.com/eggplants/twitter-weathername-action/blob/main/Dockerfile)
    - ç’°å¢ƒã®æ§‹ç¯‰
    - å®Ÿéš›ã®å‡¦ç†ã‚’å‹•ã‹ã™ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’`ENTRYPOINT`ã¨ã—ã¦å®Ÿè¡Œ
- [**å®Ÿéš›ã®å‡¦ç†ã‚’è¡Œã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ **](https://github.com/eggplants/twitter-weathername-action/blob/main/src/main.py)
    - ä»Šå›ã¯Pythonã§è¨˜è¿° 

ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

# ä½œã£ã¦ã¿ã‚‹

## actions.yml

ãã‚Œãã‚Œè¨˜è¿°ã™ã‚‹ã¹ãå€¤ã‚’åˆ—æŒ™ã—ã¾ã™ã€‚

### `name`, `author`, `description`

ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å…¬é–‹æ™‚ã®ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³åã€ã€ã€Œä½œè€…ã€ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®èª¬æ˜ã€ã§ã™ã€‚

### `inputs`

ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œæ™‚ã«æ¸¡ã›ã‚‹ã€ã€Œå¼•æ•°ã®å®šç¾©ã€ã§ã™ã€‚

ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€workflowã§ã®ä½¿ç”¨æ™‚ã«`jobs.<job_id>.steps.with`ã§æ¸¡ã•ã‚ŒãŸå¼•æ•°ã‚’å—ã‘å–ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚
å¾Œè¿°ã—ã¾ã™ãŒã€æ¸¡ã•ã‚ŒãŸå¼•æ•°`XXX`ã¯ç’°å¢ƒå¤‰æ•°`INPUT_XXX`ã¨ã—ã¦å®šç¾©ã•ã‚Œã€ENTRYPOINTå†…ã§å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
`required: true`ã¨ã—ãŸã‚‚ã®ã«é–¢ã—ã¦ã¯ã€ä½¿ç”¨æ™‚ã«æŒ‡å®šã—ãªã„ã¨å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚
ã¾ãŸ`required: false`ã®å ´åˆ(ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°)ã«ã€`default`ã§å¼•æ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’å®šç¾©ã§ãã¾ã™ã€‚

<details><summary>ä»Šå›å®šç¾©ã—ãŸå¼•æ•°</summary><div>

- å¿…é ˆå¼•æ•°
  - `open_weather_api_token`
      - [Openweathermap API](https://openweathermap.org/appid)ã®ãƒˆãƒ¼ã‚¯ãƒ³
  - `twitter_consumer_key`, `twitter_consumer_secret`, `twitter_access_key`, `twitter_access_secret`
      - [Twitter API](https://developer.twitter.com/en/docs/twitter-api/getting-started/guide)ã®ãƒˆãƒ¼ã‚¯ãƒ³
  - `location_query`
      - å¤©æ°—äºˆå ±ã®å ´æ‰€
- ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°è¨˜è¿°
  - `time_zone`
      - ç”¨ã„ã‚‹äºˆå ±ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³
      - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨`location_query`ã®å ´æ‰€ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’ç”¨ã„ã‚‹
  - `name_format`
      - å¤©æ°—äºˆå ±ã‚’ã¯ã‚è¾¼ã‚€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
  - `icon_sep`
      - å¤©æ°—ã‚’åŒºåˆ‡ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
  - `forecast_day`
      - äºˆå ±ã™ã‚‹æ—¥æ•°ã‚’næ—¥å…ˆã§è¨­å®š
      - å¤©æ°—APIã®éƒ½åˆä¸Š`0`~`2`ã§æŒ‡å®š
      - "æ˜æ—¥"ã ã¨`1`
</div></details>

### `runs`

ä»Šå›ã¯Docker Containerã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãªã®ã§ã€

```yaml:action.yml
runs:
  using: "docker"
  image: "Dockerfile"
```

ã¨ã—ã¾ã™ã€‚ä»Šå›ã¯`image`ã«ã€è‡ªåˆ†ã§ä½œæˆã—ãŸDockerfileã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ãŒã€[DockerHub](https://hub.docker.com/)ã®å…¬é–‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚„[GitHub Packagesã®å…¬é–‹ã‚³ãƒ³ãƒ†ãƒŠ](https://docs.github.com/en/free-pro-team@latest/actions/guides/publishing-docker-images)ã‚‚æŒ‡å®šã§ãã¾ã™ã€‚

### `branding`

[Marketplace](https://github.com/marketplace)ã§ã®å…¬é–‹æ™‚ã®ã‚¢ã‚¤ã‚³ãƒ³ã¨ãã®èƒŒæ™¯è‰²ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

- `icon`
  - [Feather](https://feathericons.com/)ã¨å¯¾å¿œ
- `color`
    - `white`, `yellow`, `blue`, `green`, `orange`, `red`, `purple`, `gray-dark`ã®ä¸­ã‹ã‚‰é¸ã¹ã¾ã™ã€‚

```yaml:action:yml
icon: "link"
color: "green"
```

ã ã¨ã€

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/a802318c-98cf-6937-c6c5-7aee7e8763a4.png)

ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ä»¥ä¸‹[ä½œæˆã—ãŸ](https://github.com/eggplants/twitter-weathername-action/blob/main/action.yml)`actions.yml`ã§ã™ã€‚

<details><summary>actions.yml</summary><div>


```yaml:action.yml
name: "Twitter Weathername"
author: "haruna"
description: "Update Twitè¨˜è¿°ter Username to a daily forecast of given location"
inputs:
  open_weather_api_token:
    description: "Openweathermap API Token"
    required: true
  twitter_consumer_key:
    description: "Twitter API consumer key"
    required: true
  twitter_consumer_secret:
    description: "Twitter API consumer secret key"
    required: true
  twitter_access_key:
    description: "Twitter API access key"
    required: true
  twitter_access_secret:
    description: "Twitter API access secret key"
    required: true
  location_query:
    description: "City name, state code and country code divided by comma, use ISO 3166 country codes"
    required: true
  time_zone:
    description: "Time zone to be used as a time reference (ex. Asia/Tokyo) (def: LOCATION_QUERY's local time zone)"
    required: false
  name_format:
    description: "Username format ({} is substituted by joined weather icons with icon_sep)"
    required: false
    default: "ï¼œ{}"
  icon_sep:
    description: "String for joining icons"
    required: false
    default: ":"
  forecast_day:
    description: "Show the weather in the next n days (n=0 is today)"
    required: false
    default: "0"
runs:
  using: "docker"
  image: "Dockerfile"
branding:
  icon: "link"
  color: "green"
```
</div></details>

## Dockerfile

ä»Šå›ã¯Pythonã‚’å®Ÿè¡Œã™ã‚‹ã®ã§ã€Pythonã‚’å‹•ã‹ã™ãŸã‚ã®å®Ÿè¡Œç’°å¢ƒã‚’ä½œæˆã™ã‚‹Dockerfileã‚’è¨˜è¿°ã™ã‚‹ã€‚
ã¾ãŸå¼•æ•°ã‚’å—ã‘å–ã£ã¦ã€å®Ÿéš›ã®å‡¦ç†ã‚’è¡Œã†(ã“ã“ã§ã¯Twitterã®ãƒ¦ãƒ¼ã‚¶åã‚’ã€å–å¾—ã—ãŸå¤©æ°—äºˆå ±ã«æ›´æ–°ã™ã‚‹)ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’`ENTRYPOINT`ã«æŒ‡å®šã—ã¾ã™ã€‚`CMD ["python", "/src/main.py"]`ã®ã‚ˆã†ã«æŒ‡å®šã—ã¦ã‚‚è‰¯ã„ã§ã™ã€‚

ä»¥ä¸‹[ä½œæˆã—ãŸ](https://github.com/eggplants/twitter-weathername-action/blob/main/Dockerfile)Dockerfileã§ã™ã€‚

```dockerfile:Dockerfile
FROM python:latest

ADD src /src
ADD requirements.txt /requirements.txt

RUN pip install -r requirements.txt
RUN chmod +x src/main.py

ENTRYPOINT ["/src/main.py"]
```

## å®Ÿéš›ã®å‡¦ç†ã‚’è¡Œã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ 

workflowã§æ¸¡ã•ã‚ŒãŸå¼•æ•°(ä¾‹ãˆã°`XXX`)ã¯ã€

```python:/src/main.py
from os import environ

xxx = environ.get('INPUT_XXX', 'default')
```
ã®ã‚ˆã†ã«å—ã‘å–ã‚Œã¾ã™ã€‚

ä»Šå›ã¯ã€

â‘ 3æ—¥é–“å¤©æ°—.jsonã‚’Openweathermap APIã‹ã‚‰å–å¾—
â‘¡3æ—¥é–“å¤©æ°—.jsonã‚’åå‰ã«æ•´å½¢
â‘¢Twitter APIã‹ã‚‰åå‰ã‚’æ›´æ–°

ã‚’è¡Œã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãã¾ã™ã€‚ä½œæˆã—ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯[ã“ã¡ã‚‰](https://github.com/eggplants/twitter-weathername-action/tree/main/src)ã§ã™ã€‚

# ä½œæˆã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹

ã“ã“ã¾ã§ã§ä½œæˆã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒã¡ã‚ƒã‚“ã¨å‹•ãã‹ã©ã†ã‹ã¯GitHub Actionsã§ãƒ†ã‚¹ãƒˆå‡ºæ¥ã¦ã—ã¾ã„ã¾ã™ã€‚Marketplaceã«å…¬é–‹ã™ã‚‹å‰ã«å‹•ãã‹ã©ã†ã‹ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

ã¾ãŸã€APIãƒˆãƒ¼ã‚¯ãƒ³ãªã©ã®ä¸€èˆ¬ã«å…¬é–‹ã—ãŸããªã„æ–‡å­—åˆ—ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã®`[Settings]->[Secrets]->[New repository secret]`ã‹ã‚‰è¿½åŠ ã§ãã€`${{ secrets.XXX }}`ã§å‘¼ã³å‡ºã›ã¾ã™ã€‚

ãƒªãƒã‚¸ãƒˆãƒªã§ã®pushæ¯ã«å®Ÿè¡Œã—ã¦ã€ã†ã¾ãæ›´æ–°ã§ãã‚‹ã‹è©¦ã™workflowã¯[ã“ã®ã‚ˆã†ã«](https://github.com/eggplants/twitter-weathername-action/settings/secrets/actions)ãªã‚Šã¾ã™ã€‚

```yml:.github/workflows/test.yml
name: Test
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Change Name
        uses: eggplants/twitter-weathername-action@main # ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒªãƒã‚¸ãƒˆãƒª
        with:
          open_weather_api_token: ${{ secrets.OPEN_WEATHER_API_TOKEN }}
          twitter_consumer_key: ${{ secrets.TWITTER_CONSUMER_KEY }}
          twitter_consumer_secret: ${{ secrets.TWITTER_CONSUMER_SECRET }}
          twitter_access_key: ${{ secrets.TWITTER_ACCESS_KEY }}
          twitter_access_secret: ${{ secrets.TWITTER_ACCESS_SECRET }}
          location_query: tsukuba
          name_format: "æ˜æ—¥: {}"
          icon_sep: "/"
          forecast_day: 1 # æ˜æ—¥ã®å¤©æ°—
```

ã†ã¾ãå‹•ã„ãŸã‹ã©ã†ã‹ã¯ã€[Actionsã‚¿ãƒ–](https://github.com/eggplants/twitter-weathername-action/actions?query=workflow%3ATest)ã‹ã‚‰ç¢ºèªã§ãã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/aefbcb33-7736-bcfe-e943-092052605307.png)

# Marketplaceã«å…¬é–‹ã™ã‚‹

ä½œæˆã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’Marketplaceã«å…¬é–‹ã™ã‚‹ã“ã¨ã§ã€èª°ã«ã§ã‚‚ç°¡å˜ã«ã€ã™ãä½œæˆã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã£ã¦ã‚‚ã‚‰ãˆã‚‹ã‚ˆã†ã«å‡ºæ¥ã¾ã™ã€‚

è©³ç´°ãªæ‰‹é †ã¯[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.github.com/en/free-pro-team@latest/actions/creating-actions/publishing-actions-in-github-marketplace#about-publishing-actions)ãŒã‚ã‹ã‚Šã‚„ã™ã„ã§ã™ã€‚

`action.yml`ãŒãƒªãƒã‚¸ãƒˆãƒªã«å­˜åœ¨ã—ã¦ã„ã‚Œã°ã€ãƒªãƒã‚¸ãƒˆãƒªã«`[Draft a release]`ãƒãƒŠãƒ¼ãŒå‡ºç¾ã—ã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/1de1de4e-4568-94ef-e15c-bf6c78111a62.png)

ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/28f0345b-7e6c-cca0-ad0f-962fdd64f6cd.png)

ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€`accept the GitHub Marketplace Developer Agreement`ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/f7029bab-89ea-7619-cea8-d1dd0c5fc5d2.png)


[GitHub Marketplace Developer Agreement](https://docs.github.com/en/free-pro-team@latest/github/site-policy/github-marketplace-developer-agreement)ã«åŒæ„ã™ã‚‹ã‚ˆã†ã«è¨€ã‚ã‚Œã¾ã™ã€‚

åŒæ„ã™ã‚‹ã¨ã€

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/ff0c42e5-b2c1-58c4-b229-ee80493d842d.png)

ã®ã‚ˆã†ã«ã€`actions.yml`ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒè¶³ã‚Šã¦ã„ã‚‹ã‹ã€ã¾ãŸ`README`ãŒã‚ã‚‹ã‹ã©ã†ã‹ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã€ä¸ååˆ†ã ã¨ä¿®æ­£ã™ã‚‹ã‚ˆã†ã«è¨€ã‚ã‚Œã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/af0d841d-591d-e7e1-83a9-f909b42ef5c8.png)


ã‚«ãƒ†ã‚´ãƒªã‚’è¨­å®šã—ã€`[Publish release]`ãƒœã‚¿ãƒ³(ç”»åƒã§ã¯`Update release`ã§ã™ãŒâ€¦)ã‚’æŠ¼ä¸‹ã—ã¦ã€å…¬é–‹ã§ãã¾ã™ã€‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼

# å…¬é–‹ã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šæœŸå®Ÿè¡Œã—ã¦ä½¿ã£ã¦ã¿ã‚‹

æœ€åˆã«æ›¸ã„ãŸã‚ˆã†ã«ã€Actionsã®workflowã®å®Ÿè¡Œãƒˆãƒªã‚¬ã«ã¯ã€cronã®ã‚ˆã†ã«å®šæœŸå®Ÿè¡Œã§ãã‚‹`schedule`ãƒˆãƒªã‚¬ãŒå­˜åœ¨ã—ã¦ãŠã‚Šã€

```yaml:cron_renamer.yml
on:
  schedule:
    - cron: "0 15 * * *" # JSTã§ã¯"0 0 * * *"
```

ã®ã‚ˆã†ã«ã€ã¾ã•ã«cronã®æ§‹æ–‡ã§å®šæœŸå®Ÿè¡Œã§ãã¾ã™ã€‚ã“ã“ã§æ³¨æ„ã§ã™ãŒã€Actionsã®workflowã¯**UTC**(å”å®šä¸–ç•Œæ™‚)ã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€æ—¥æœ¬æ™‚é–“ã«å³ã—ãŸå®Ÿè¡Œã‚’è¡Œã„ãŸã„å ´åˆã¯**JST**(æ—¥æœ¬æ¨™æº–æ™‚)**-9**ã®æ™‚é–“ã‚’æŒ‡å®šã—ã¾ã—ã‚‡ã†ã€‚

ä»¥ä¸‹ãŒã€ç¾åœ¨[å®Ÿéš›ã«ä½¿ã£ã¦ã„ã‚‹](https://github.com/eggplants/twitter-weathername-action/blob/main/.github/workflows/cron_renamer.yml)cron workflowã§ã™ã€‚

```yaml:cron_renamer.yml
name: Cron renamer

on:
  schedule:
    - cron: "0 15 * * *"

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Change Name
        uses: eggplants/twitter-weathername-action@v2
        with:
          open_weather_api_token: ${{ secrets.OPEN_WEATHER_API_TOKEN }}
          twitter_consumer_key: ${{ secrets.TWITTER_CONSUMER_KEY }}
          twitter_consumer_secret: ${{ secrets.TWITTER_CONSUMER_SECRET }}
          twitter_access_key: ${{ secrets.TWITTER_ACCESS_KEY }}
          twitter_access_secret: ${{ secrets.TWITTER_ACCESS_SECRET }}
          location_query: tsukuba
          name_format: "æ˜æ—¥: {}"
          icon_sep: "/"
          forecast_day: 1
```

å®Ÿè¡Œãƒ­ã‚°ã¯ãƒ†ã‚¹ãƒˆåŒæ§˜[Actionsã‚¿ãƒ–](https://github.com/eggplants/twitter-weathername-action/actions?query=workflow%3A%22Cron+renamer%22)ã‹ã‚‰ç¢ºèªã§ãã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/278919/d52a9169-7fc8-71a3-aa62-b0897234bb92.png)

# ãŠã‚ã‚Šã«

GitHub Actionsã®è‡ªä½œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®ä½œæˆã¨ãƒ†ã‚¹ãƒˆã€å…¬é–‹ã‚„å®šæœŸå®Ÿè¡Œã®æ‰‹é †ãŒã²ã¨ã¨ã“ã‚ã«ã‚ã‚‹ã‚ã‹ã‚Šã‚„ã™ã„è¨˜äº‹ãŒãªã‹ãªã‹ãªã‹ã£ãŸã®ã§ã€å‚™å¿˜éŒ²ã‚‚å…¼ã­ã¦æ›¸ã“ã†ã¨ãšã£ã¨æ€ã£ã¦ãŸã‚“ã§ã™ã‘ã©ã€ä»Šå›Adventã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãŒè‰¯ã„å¥‘æ©Ÿã¨ãªã‚Šã¾ã—ãŸã€‚

è‰¯ã„ãŠå¹´ã‚’ã€œ

